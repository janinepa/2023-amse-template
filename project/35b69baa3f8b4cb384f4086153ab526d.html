<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>a9835cd377fe498293b90d5f585891bf</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<section id="report-train-delays-and-weather-correlation-in-germany"
class="cell markdown">
<h1>Report: Train delays and weather correlation in germany</h1>
</section>
<section id="1-project-idea" class="cell markdown">
<h2>1. Project Idea</h2>
<p>Every day, 7.3 milion people in Germany rely on DB trains <a
href="https://www.germany.travel/de/trade/global-trade-corner/deutsche-bahn-ag-db.html">^1</a>,
which is about every 10th person in Germany. It is rare to find someone
who hasn't experienced any issues with DB train. Personally, every time
I take the train to get somewhere, I experience delays, missed
connections, or even cancellations. This has led me to the question of
the underlying causes. I have the feeling that there may be an
association between heavy rain or thunderstorms and an increase in train
delays. This observation has led to look into a possible correlation
between bad weather conditions and train delays.</p>
<p>Uncovering the reasons behind these delays would be of great benefit
to the 7.3 million daily passengers who rely on DB trains. With this
knowledge, people can plan their trips more efficiently. If people know
that there will be bad weather on the day they want to travel, they can
plan extra time for connecting trains or look for alternative
transportations. Germans, known for their need for planning and
punctuality, would greatly benefit from being aware of such a
correlation.</p>
<p>While it may be unrealistic to find a single cause of train delays,
it would still be useful to draw a connection between train delays and
rainy weather. Therefore, the question that the following report
attempts to answer is:</p>
<p><strong>When investigating DB train delays, is there a correlation
between more trains running late or more minutes of delay and rainy
weather?</strong></p>
</section>
<section id="2-data-sources-und-data-pipeline" class="cell markdown">
<h2>2. Data sources und Data pipeline</h2>
<p>To collect the necessary data for this project, different APIs and
files were used. Mobilithek provides links to various DB APIs for train
information, including the Timetable API <a
href="https://mobilithek.info/offers/-3916716856299319220">^2</a>. This
API offers timetable information containing planned and changed
timetables for long-distance trains <a
href="https://mobilithek.info/offers/-3916716856299319220">^2</a>. The
data is offered by DB Station&amp;Service AG and is made available under
the Creative Commons Attribution 4.0 International (CC BY 4.0) license
<a href="https://creativecommons.org/licenses/by/4.0/">^3</a>. An
overview of the API can be found on the DB API Marketplace <a
href="https://developers.deutschebahn.com/db-api-marketplace/apis/product/timetables/api/26494#/Timetables_10213/overview">^4</a>.</p>
<p><img src="timetable_api.png" alt="timetable api" title="DB timetable API" width="200"></p>
<p>The desired data is collected using the Timetables API Version
1.0.213, utilizing the endpoints /fchg to get the current full changes
of the timetable of a specific station and the endpoint /station to
obtain all stations in germany.</p>
<p>Furthermore, geographical data, such as longitude and latitude of the
train station,has to be collected separately from the Station Data API
Version 2.7.423 and the endpoint /stations.</p>
<p><img src="meteostat.png" alt="meteostat" title="Meteostat" width="200"></p>
<p>Weather data was collected from Meteostat Developers <a
href="https://dev.meteostat.net/">^5</a>, who offers historical weather
and climate data also provided under the CC BY 4.0 license. The endpoint
/station was used to obtain all weather stations and the endpoint
/hourly to get the weather data for the desired stations.</p>
<p>The data pipeline includes some dependencies to manage data loading
efficiently and prevent unnecessary slowdowns by getting unnessecary
data. The key steps in the pipeline are getting all main train stations
in germany, retrieving matching timetables and geo data. Then all
weather stations in germany are obtained and matched with the train
station, to collect weather data solely for the desired stations.</p>
<p>Data Sources: <a href="https://meteostat.net/en/">Meteostat</a> and
<a href="https://www.bahnhof.de/">DB Station&amp;Service AG</a></p>
</section>
<section id="3-main-problems-and-mitigations" class="cell markdown">
<h2>3. Main Problems and Mitigations</h2>
<h3 id="31-train-stations">3.1 Train stations</h3>
<p>Given the big number of train stations in germany (17081 to be exact,
given by the API), it was necessary to filter the data for the main
stations in germany. To simplify the task only train station with the
addition "Hbf" where obtained.</p>
<h3 id="32-timetables">3.2 Timetables</h3>
<p>The main problem of the API was that there is no historical data on
train delays available. To still obtain some data to work with, I set up
a cron job to run the pipeline every hour for the past weeks. However,
this approach resulted in duplicate entries for trains. To address this,
I kept only the most recent update of the timetable for each train.</p>
<p>The timetables obtained from the API come in a weird XML format. To
still extract the desired information, I filtered for train departures
and retrieved the planned and changed times, allowing the calculation of
delays. I considered a train delayed if it had a delay of more than 5
minutes.</p>
<h3 id="33-weather-stations">3.3 Weather stations</h3>
<p>Obtaining weather data for all available weather stations was not
possible due to the large amount of data. To mitigate this, I matched
the train stations to the nearest weather stations using a
nearest-neighbor approach and obtained weather data solely for the
desired weather stations. Furthermore, I restricted the data to the year
2023.</p>
<p>Unfortunately, there was an unhappy coincidence in the past weeks
because there was very little rain. The limited timeframe and the
limited rainy days makes it challenging to make out a significant
correlation.</p>
</section>
<section id="4-answer-data-science-question" class="cell markdown">
<h2>4. Answer Data Science Question</h2>
<h3 id="install-dependencies">Install dependencies</h3>
</section>
<div class="cell code" data-execution_count="1">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.io <span class="im">as</span> pio</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
</code></pre>
</div>
</div>
<section id="load-data" class="cell markdown">
<h3>Load data</h3>
<p>The data was preprocessed in an earlier stage, and now the final
datasets are being loaded. The timetables dataset includes the eva
number and station name, coordinates and the date. The dates were
transformed into one-hour increments, and for each hour, the number of
trains with delays and the total sum of delayed minutes were calculated
and added.</p>
<p>In the weather table, each entry consists of the id and the name of
the weather station, its coordinates, the hourly precipitation total in
millimeters, and the temperature for the corresponding hourly date .</p>
<p>To bring together the timetables and weather data, a helper matching
table was utilized. This table allowed the matching of the nearest
weather station to each train station. This dataset is the final data
set with all relevant information.</p>
</section>
<div class="cell code" data-execution_count="2">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>timetables<span class="op">=</span>pd.read_sql_table(<span class="st">&#39;all_timetables&#39;</span>,<span class="st">&#39;sqlite:///data/amse.sqlite&#39;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>timetables.head(<span class="dv">1</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="2">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>eva</th>
      <th>count</th>
      <th>name</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>date</th>
      <th>delay</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8000261</td>
      <td>1</td>
      <td>München Hbf</td>
      <td>48.140232</td>
      <td>11.558335</td>
      <td>2023-06-13 11</td>
      <td>79.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="3">
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>weather<span class="op">=</span>pd.read_sql_table(<span class="st">&#39;all_weather&#39;</span>,<span class="st">&#39;sqlite:///data/amse.sqlite&#39;</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>weather.head(<span class="dv">1</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="3">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>temp</th>
      <th>prcp</th>
      <th>datetime</th>
      <th>id</th>
      <th>name</th>
      <th>longitude</th>
      <th>latitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>16.2</td>
      <td>0.0</td>
      <td>2023-06-14 00</td>
      <td>10501</td>
      <td>{'en': 'Aachen'}</td>
      <td>6.1</td>
      <td>50.7833</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="4">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>final_table<span class="op">=</span>pd.read_sql_table(<span class="st">&#39;final_table&#39;</span>,<span class="st">&#39;sqlite:///data/amse.sqlite&#39;</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>final_table.head(<span class="dv">1</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="4">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>temp</th>
      <th>prcp</th>
      <th>datetime</th>
      <th>id</th>
      <th>name_x</th>
      <th>longitude_x</th>
      <th>latitude_x</th>
      <th>name_y</th>
      <th>evaNumbers</th>
      <th>latitude_y</th>
      <th>...</th>
      <th>longitude_matched</th>
      <th>latitude_matched</th>
      <th>Distance</th>
      <th>date</th>
      <th>eva</th>
      <th>count</th>
      <th>name</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>delay</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>16.2</td>
      <td>0.0</td>
      <td>2023-06-14 00</td>
      <td>10501</td>
      <td>{'en': 'Aachen'}</td>
      <td>6.1</td>
      <td>50.7833</td>
      <td>Aachen Hbf</td>
      <td>8000001.0</td>
      <td>50.7678</td>
      <td>...</td>
      <td>6.1</td>
      <td>50.7833</td>
      <td>0.000286</td>
      <td>2023-06-14 00</td>
      <td>8000001</td>
      <td>0.0</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 22 columns</p>
</div>
</div>
</div>
<section id="how-does-the-number-of-delayed-trains-develope-over-time"
class="cell markdown">
<h3>How does the number of delayed trains develope over time?</h3>
<p>To answer that, plotly was used to draw a scatterplot of all train
stations, overlaying it on a map from OpenStreetMap. The size of the
datapoints correspond to the number of delayed trains. A date animation
was added to show the development over time sliced in hourly
segments.</p>
</section>
<div class="cell code" data-execution_count="5" data-scrolled="true">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>pio.renderers.default <span class="op">=</span> <span class="st">&quot;iframe&quot;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.scatter_mapbox(timetables, lat<span class="op">=</span><span class="st">&quot;latitude&quot;</span>, lon<span class="op">=</span><span class="st">&quot;longitude&quot;</span>, hover_name<span class="op">=</span><span class="st">&quot;name&quot;</span>, size<span class="op">=</span><span class="st">&#39;count&#39;</span>,zoom<span class="op">=</span><span class="dv">5</span>,  animation_frame<span class="op">=</span><span class="st">&#39;date&#39;</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>fig.update_layout(mapbox_style<span class="op">=</span><span class="st">&quot;open-street-map&quot;</span>,margin<span class="op">=</span>{<span class="st">&quot;r&quot;</span>:<span class="dv">0</span>,<span class="st">&quot;t&quot;</span>:<span class="dv">0</span>,<span class="st">&quot;l&quot;</span>:<span class="dv">0</span>,<span class="st">&quot;b&quot;</span>:<span class="dv">0</span>})</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code></pre></div>
<div class="output display_data">
<iframe
    scrolling="no"
    width="100%"
    height="545px"
    src="iframe_figures/figure_5.html"
    frameborder="0"
    allowfullscreen
></iframe>

</div>
</div>
<div class="cell markdown">
<p>When analyzing the data shown, it becomes clear that more trains are
delayed in the afternoon and evening than at night or in the morning.
Delayed trains pile up around Düsseldorf and Frankfurt.</p>
</div>
<section id="what-is-the-station-with-the-most-delayed-trains-per-hour"
class="cell markdown">
<h3>What is the station with the most delayed trains per hour?</h3>
</section>
<div class="cell code" data-execution_count="6" data-scrolled="true"
data-tags="[]">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>final_table.loc[final_table[<span class="st">&#39;count&#39;</span>].idxmax()][[<span class="st">&#39;eva&#39;</span>,<span class="st">&#39;name&#39;</span>,<span class="st">&#39;date&#39;</span>,<span class="st">&#39;count&#39;</span>]]</span></code></pre></div>
<div class="output execute_result" data-execution_count="6">
<pre><code>eva            8000152
name      Hannover Hbf
date     2023-06-26 20
count             18.0
Name: 1943165, dtype: object</code></pre>
</div>
</div>
<section
id="what-is-the-average-number-of-delayed-trains-over-the-whole-dataset"
class="cell markdown">
<h3>What is the average number of delayed trains over the whole
dataset?</h3>
</section>
<div class="cell code" data-execution_count="7">
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;The average number of delayed trains per hour is: </span><span class="sc">{:0.2f}</span><span class="st">&#39;</span>.<span class="bu">format</span>(final_table[<span class="st">&#39;count&#39;</span>].mean()))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>The average number of delayed trains per hour is: 1.80
</code></pre>
</div>
</div>
<section
id="is-there-a-significant-different-to-the-sum-of-the-delay-minutes"
class="cell markdown">
<h3>Is there a significant different to the sum of the delay
minutes?</h3>
<p>When investigating the delays of trains, the number of minutes the
trains are late could also be interesting. This is because fewer trains
and more minutes of delay can be just as interesting as many trains with
an arbitrary number of delays.</p>
</section>
<div class="cell code" data-execution_count="8" data-scrolled="true">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.scatter_mapbox(timetables[timetables[<span class="st">&#39;delay&#39;</span>]<span class="op">&gt;</span><span class="dv">0</span>], lat<span class="op">=</span><span class="st">&quot;latitude&quot;</span>, lon<span class="op">=</span><span class="st">&quot;longitude&quot;</span>, hover_name<span class="op">=</span><span class="st">&quot;name&quot;</span>, size<span class="op">=</span><span class="st">&#39;delay&#39;</span>,zoom<span class="op">=</span><span class="dv">5</span>,  animation_frame<span class="op">=</span><span class="st">&#39;date&#39;</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>fig.update_layout(mapbox_style<span class="op">=</span><span class="st">&quot;open-street-map&quot;</span>,margin<span class="op">=</span>{<span class="st">&quot;r&quot;</span>:<span class="dv">0</span>,<span class="st">&quot;t&quot;</span>:<span class="dv">0</span>,<span class="st">&quot;l&quot;</span>:<span class="dv">0</span>,<span class="st">&quot;b&quot;</span>:<span class="dv">0</span>})</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code></pre></div>
<div class="output display_data">
<iframe
    scrolling="no"
    width="100%"
    height="545px"
    src="iframe_figures/figure_8.html"
    frameborder="0"
    allowfullscreen
></iframe>

</div>
</div>
<div class="cell markdown">
<p>No significant change is observed in the shown data. The report will
continue to use the number of train delay as the attribute to be
examined.</p>
</div>
<section
id="what-is-the-average-number-of-minutes-of-delay-over-the-whole-dataset"
class="cell markdown">
<h3>What is the average number of minutes of delay over the whole
dataset?</h3>
</section>
<div class="cell code" data-execution_count="9">
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;The average number of minutes of delay per hour is: </span><span class="sc">{:0.2f}</span><span class="st">&#39;</span>.<span class="bu">format</span>(final_table[<span class="st">&#39;delay&#39;</span>].mean()))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>The average number of minutes of delay per hour is: 81.79
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>This is surprising, as the average delay per hour is more than one
hour. But is it really surprising for regular passengers of DB?</p>
</div>
<section
id="where-are-the-main-stations-in-germany-and-where-are-the-matching-weather-stations"
class="cell markdown">
<h3>Where are the main stations in germany and where are the matching
weather stations?</h3>
<p>To answer this question, we again use Plotly to draw a scatter plot
of all train stations and weather stations and overlay it on a map from
OpenStreetMap. The final dataset contains the desired coordinates for
the train stations and the corresponding weather stations. The train
stations are drawn in blue and the weather stations in red.</p>
</section>
<div class="cell code" data-execution_count="10" data-scrolled="true">
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scattermapbox(lat<span class="op">=</span>final_table[<span class="st">&#39;latitude&#39;</span>],lon<span class="op">=</span>final_table[<span class="st">&#39;longitude&#39;</span>],mode<span class="op">=</span><span class="st">&#39;markers&#39;</span>,marker<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">10</span>,color<span class="op">=</span><span class="st">&#39;blue&#39;</span>,symbol<span class="op">=</span><span class="st">&#39;circle&#39;</span>,opacity<span class="op">=</span><span class="fl">0.7</span>),text<span class="op">=</span>final_table[<span class="st">&#39;name&#39;</span>], hoverinfo<span class="op">=</span><span class="st">&#39;text&#39;</span>,name<span class="op">=</span><span class="st">&#39;Train stations&#39;</span>))</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scattermapbox(lat<span class="op">=</span>final_table[<span class="st">&#39;latitude_matched&#39;</span>],lon<span class="op">=</span>final_table[<span class="st">&#39;longitude_matched&#39;</span>],mode<span class="op">=</span><span class="st">&#39;markers&#39;</span>,marker<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">10</span>,color<span class="op">=</span><span class="st">&#39;red&#39;</span>,symbol<span class="op">=</span><span class="st">&#39;circle&#39;</span>,opacity<span class="op">=</span><span class="fl">0.7</span>),text<span class="op">=</span>final_table[<span class="st">&#39;name_train&#39;</span>],hoverinfo<span class="op">=</span><span class="st">&#39;text&#39;</span>,name<span class="op">=</span><span class="st">&#39;Weather stations&#39;</span>))</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>fig.update_layout(mapbox_style<span class="op">=</span><span class="st">&#39;open-street-map&#39;</span>,mapbox_zoom<span class="op">=</span><span class="dv">5</span>,mapbox_center<span class="op">=</span>{<span class="st">&#39;lat&#39;</span>: final_table[<span class="st">&#39;latitude&#39;</span>].mean(), <span class="st">&#39;lon&#39;</span>: final_table[<span class="st">&#39;longitude&#39;</span>].mean()},margin<span class="op">=</span>{<span class="st">&quot;r&quot;</span>: <span class="dv">0</span>, <span class="st">&quot;t&quot;</span>: <span class="dv">0</span>, <span class="st">&quot;l&quot;</span>: <span class="dv">0</span>, <span class="st">&quot;b&quot;</span>: <span class="dv">0</span>},showlegend<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code></pre></div>
<div class="output display_data">
<iframe
    scrolling="no"
    width="100%"
    height="545px"
    src="iframe_figures/figure_10.html"
    frameborder="0"
    allowfullscreen
></iframe>

</div>
</div>
<div class="cell markdown">
<p>Based on this plot, it can be seen that the coordinate matching
worked and the weather station closest to a train station was
selected.</p>
</div>
<section id="how-does-the-rain-develope-over-time" class="cell markdown"
data-tags="[]">
<h3>How does the rain develope over time?</h3>
<p>Now let's continue with the weather data. Since rain is the most
important indicator of bad weather, the amount of precipitation was
used. It is again a map displayed with an animation over time.</p>
</section>
<div class="cell code" data-execution_count="11">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.scatter_mapbox(weather, lat<span class="op">=</span><span class="st">&quot;latitude&quot;</span>, lon<span class="op">=</span><span class="st">&quot;longitude&quot;</span>,  hover_name<span class="op">=</span><span class="st">&quot;name&quot;</span>,  size<span class="op">=</span><span class="st">&#39;prcp&#39;</span>, zoom<span class="op">=</span><span class="dv">5</span>, animation_frame<span class="op">=</span><span class="st">&#39;datetime&#39;</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>fig.update_layout(mapbox_style<span class="op">=</span><span class="st">&quot;open-street-map&quot;</span>,margin<span class="op">=</span>{<span class="st">&quot;r&quot;</span>:<span class="dv">0</span>,<span class="st">&quot;t&quot;</span>:<span class="dv">0</span>,<span class="st">&quot;l&quot;</span>:<span class="dv">0</span>,<span class="st">&quot;b&quot;</span>:<span class="dv">0</span>})</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code></pre></div>
<div class="output display_data">
<iframe
    scrolling="no"
    width="100%"
    height="545px"
    src="iframe_figures/figure_11.html"
    frameborder="0"
    allowfullscreen
></iframe>

</div>
</div>
<div class="cell markdown">
<p>It can be observed that in the first week there is basically no rain
in the whole of Germany. Then it rains only scattered in the north of
Germany, especially near Düsseldorf and Berlin. This is very unlucky,
because the desired correlation would need more data for rainy days.</p>
</div>
<section id="what-is-the-station-with-the-most-rain"
class="cell markdown">
<h3>What is the station with the most rain?</h3>
</section>
<div class="cell code" data-execution_count="12" data-scrolled="true">
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>final_table.loc[final_table[<span class="st">&#39;prcp&#39;</span>].idxmax()][[<span class="st">&#39;id&#39;</span>,<span class="st">&#39;name_x&#39;</span>,<span class="st">&#39;date&#39;</span>,<span class="st">&#39;prcp&#39;</span>]]</span></code></pre></div>
<div class="output execute_result" data-execution_count="12">
<pre><code>id                        D4032
name_x    {&#39;en&#39;: &#39;Quedlinburg&#39;}
date              2023-06-21 01
prcp                       20.4
Name: 985098, dtype: object</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Unfortunately, this is a different date and a different station than
the train station with the longest delay of one hour.</p>
</div>
<section id="how-does-delay-and-rain-develop-over-time-together"
class="cell markdown">
<h3>How does delay and rain develop over time together?</h3>
<p>Let's overlay the two datasets and try to determine a correlation
between the number of delays at a station and the amount of rain at the
nearest weather station. For this purpose, the final dataset was used
and plotted on OpenStreetMap. Again, blue are the train stations and red
are the weather stations. The animation shows the given time frame by
hour.</p>
</section>
<div class="cell code" data-execution_count="13" data-scrolled="true">
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.scatter_mapbox(final_table, lat<span class="op">=</span><span class="st">&quot;latitude&quot;</span>, lon<span class="op">=</span><span class="st">&quot;longitude&quot;</span>,hover_name<span class="op">=</span><span class="st">&quot;name&quot;</span>,  size<span class="op">=</span><span class="st">&#39;count&#39;</span>, zoom<span class="op">=</span><span class="dv">5</span>, animation_frame<span class="op">=</span><span class="st">&#39;datetime&#39;</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>fig2 <span class="op">=</span> px.scatter_mapbox(final_table, lat<span class="op">=</span><span class="st">&quot;latitude_x&quot;</span>, lon<span class="op">=</span><span class="st">&quot;longitude_x&quot;</span>,hover_name<span class="op">=</span><span class="st">&quot;name_x&quot;</span>,  size<span class="op">=</span><span class="st">&#39;prcp&#39;</span>, zoom<span class="op">=</span><span class="dv">5</span>, animation_frame<span class="op">=</span><span class="st">&#39;datetime&#39;</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> frame_data <span class="kw">in</span> fig.frames:</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> trace <span class="kw">in</span> frame_data.data:</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>        trace.marker.color <span class="op">=</span> <span class="st">&#39;blue&#39;</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>        trace.name <span class="op">=</span> <span class="st">&#39;Train stations&#39;</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> frame_data <span class="kw">in</span> fig2.frames:</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> trace <span class="kw">in</span> frame_data.data:</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>        trace.marker.color <span class="op">=</span> <span class="st">&#39;red&#39;</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>        trace.name <span class="op">=</span> <span class="st">&#39;Weather stations&#39;</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>fig.add_trace(fig2.data[<span class="dv">0</span>])</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> fe, fne <span class="kw">in</span> <span class="bu">zip</span>(fig.frames, fig2.frames):</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    fe.update(data<span class="op">=</span>fe.data <span class="op">+</span> fne.data)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>fig.update_layout(mapbox_style<span class="op">=</span><span class="st">&quot;open-street-map&quot;</span>,margin<span class="op">=</span>{<span class="st">&quot;r&quot;</span>:<span class="dv">0</span>,<span class="st">&quot;t&quot;</span>:<span class="dv">0</span>,<span class="st">&quot;l&quot;</span>:<span class="dv">0</span>,<span class="st">&quot;b&quot;</span>:<span class="dv">0</span>},showlegend<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code></pre></div>
<div class="output display_data">
<iframe
    scrolling="no"
    width="100%"
    height="545px"
    src="iframe_figures/figure_13.html"
    frameborder="0"
    allowfullscreen
></iframe>

</div>
</div>
<div class="cell markdown">
<p>Due to the absence of rainfall during the first week, nothing can be
observed. The first notable rainfall occurred on June 20th at 1 AM near
Mannheim. However, as there are typically fewer train delays during
nighttime due to a reduced number of train services, no clear
correlation could be observed in this case.</p>
<p>On June 20th, there was a pile up of delays near Düsseldorf. However,
the rainfall during that time was near Berlin, resulting in no match.
More situations like that occurred throughout the observed
timeframe.</p>
<p>A different observation emerged on June 22nd at 2 PM, where numerous
delays were observed around Düsseldorf, coinciding with rain in that
region. This effect stayed until the evening, and a similar pattern was
observed in Hannover. Unfortunately, delay pile ups in the Düsseldorf
region were observed on multiple dates, not exclusively on that rainy
day. Hence, this specific observation cannot be generalized as a
consistent correlation.</p>
</div>
<section id="what-is-the-correlation-between-rain-and-delay"
class="cell markdown">
<h3>What is the correlation between rain and delay?</h3>
<p>Let's see what the numbers tell us about the correlation. For this
purpose, the correlation between the number of delays and the
precipitation for each station for the respective time was calculated.
Then the average value of these numbers was calculated.</p>
</section>
<div class="cell code" data-execution_count="14" data-scrolled="true">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>evas <span class="op">=</span> final_table[<span class="st">&#39;evaNumbers&#39;</span>].unique()</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>correlations <span class="op">=</span> []</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> eva <span class="kw">in</span> evas:</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>        subset <span class="op">=</span> final_table[(final_table[<span class="st">&#39;evaNumbers&#39;</span>] <span class="op">==</span> eva)]</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>        subset_nonzero <span class="op">=</span> subset[(subset[<span class="st">&#39;prcp&#39;</span>] <span class="op">!=</span> <span class="dv">0</span>) <span class="op">&amp;</span> (subset[<span class="st">&#39;count&#39;</span>] <span class="op">!=</span> <span class="dv">0</span>)]</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(subset_nonzero) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>            correlation <span class="op">=</span> subset_nonzero[<span class="st">&#39;count&#39;</span>].corr(subset_nonzero[<span class="st">&#39;prcp&#39;</span>])</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>            correlation <span class="op">=</span> np.nan</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>        correlations.append(correlation)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>average_correlation <span class="op">=</span> np.nanmean(correlations)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>average_correlation</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
</code></pre>
</div>
<div class="output execute_result" data-execution_count="14">
<pre><code>0.03610243924162731</code></pre>
</div>
</div>
<div class="cell markdown">
<p>As expected, the correlation is close to zero. A different result
would have been surprising, since we could not detect many coincident
rain events and delays in the plots above. To perhaps get a different
perspective, the delays and rain events were plotted on a scatter plot.
Blue dots are delays and red dots are rain. For each hour, the values
for delay and rain were plotted for all stations.</p>
</div>
<div class="cell code" data-execution_count="15">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>sns.set_style(<span class="st">&quot;white&quot;</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>sns.despine(left<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>correlation <span class="op">=</span> final_table[<span class="st">&#39;count&#39;</span>].corr(final_table[<span class="st">&#39;prcp&#39;</span>])</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>plt.scatter(final_table[<span class="st">&#39;date&#39;</span>], final_table[<span class="st">&#39;count&#39;</span>], label<span class="op">=</span><span class="st">&#39;Count&#39;</span>,c<span class="op">=</span><span class="st">&#39;blue&#39;</span>,alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>plt.scatter(final_table[<span class="st">&#39;date&#39;</span>], final_table[<span class="st">&#39;prcp&#39;</span>], label<span class="op">=</span><span class="st">&#39;Precipitation&#39;</span>,c<span class="op">=</span><span class="st">&#39;red&#39;</span>,alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Date&#39;</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Value&#39;</span>)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Correlation between Count and Precipitation</span><span class="ch">\n</span><span class="st">Correlation Coefficient: </span><span class="sc">{:.2f}</span><span class="st">&#39;</span>.<span class="bu">format</span>(average_correlation))</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>xticklabels <span class="op">=</span> plt.gca().get_xticklabels()</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, label <span class="kw">in</span> <span class="bu">enumerate</span>(xticklabels):</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">%</span> <span class="dv">24</span> <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>        label.set_visible(<span class="va">False</span>)</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Intel MKL WARNING: Support of Intel(R) Streaming SIMD Extensions 4.2 (Intel(R) SSE4.2) enabled only processors has been deprecated. Intel oneAPI Math Kernel Library 2025.0 will require Intel(R) Advanced Vector Extensions (Intel(R) AVX) instructions.
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_35b69baa3f8b4cb384f4086153ab526d/1370c92c948203918b58b6b8b2c826133beee345.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>Again, no real correlation can be seen, but at least this graph shows
the three rain events well. It can also be seen that train delays vary
with day and night.</p>
</div>
<section id="5-conclusion" class="cell markdown">
<h2>5. Conclusion</h2>
<p>Unfortunatly, the limited timeframe made it hard to identify a
significant correlation and draw a definitive conclusion. I have tried
to show what would have been possible with more data and a longer
timeframe.</p>
<p>In addition, it has to be considered that there are other causes of
the train delayes. Even during the past week with really good weather,
delays still occured. Signal failures, technical issues, accidents
causing emergency services on the tracks, and staff-related factors,
such as illness or waiting for staff from other trains, can all
independently contribute to delays. Additionally, delays can propagate,
creating a cascading effect.</p>
<p>While the correlation between weather and train delays could not be
fully established, it is clear that multiple causes influence the DB
train timetables.</p>
</section>
</body>
</html>
